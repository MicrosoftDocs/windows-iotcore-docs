---
title: Capturing Fiddler Traces
author: saraclay
ms.author: saclayt
ms.date: 08/28/2017
ms.topic: article
description: Learn how to use Fiddler to capture Fiddler traces on Windows IoT Core.
keywords: windows iot, Fiddler, traces, PuTTY, Fiddler traces
---

# Capturing Fiddler Traces on Windows IoT Core

Fiddler is a tool for debugging web traffic. It's particularly helpful because you can customize it for specific needs using extensions and add-ons, and the tool provides a lot of useful information specific to web traffic.

## Assumptions 

* You have [PuTTY](http://www.putty.org/) on your developer box or an alternative for SSH
* The instructions below make the assumption of a IoT Core VM but will work on *any* IoT Core device

## Initial Setup

1. Download and install the latest version of [Fiddler](http://www.telerik.com/fiddler/) on your developer box if you haven't already
2. Start Fiddler and make the following setting updates under _Tools -> Telerik Fiddler Options -> HTTPS_ tab
	* Check _Capture HTTPS CONNECTs_
	* Check _Decrypt HTTPS Traffic -> from all processes_
	* Click on the 'Certificates generated by' link and select _MakeCert engine_ 
		(Recommendation: Restart Fiddler for this change to take effect)
	* Next, export the FiddlerRoot.cer file via _Actions -> Export Root Certificate To Desktop_
3. Make the following setting updates under _Tools -> Telerik Fiddler Options -> Connections_ tab:
	* Setup Fiddler to act as a system proxy by checking _Allow Remote Computers to Connect_
	* _Fiddler listens on port_ should be set to _8888_
  
Note: You should restart Fiddler after this and accept any UAC prompt.

## Transfer and Import Fiddler Root Certificate
You'll need to import the Fiddler root certificate to your IoT image or device in order to debug https traffic routing through your PC.  To do this:

1. Mount the VHD file (right click on the VHD and choose _mount_) or connect to your IoT device via PuTTY (or alternative SSH client)
2. Browse to the mainOS partition and create a _test_ folder at root (via SSH, use _md c:\test_)
3. Copy FiddlerRoot.cer you generated above (should be on your desktop by default) to the test folder location
4. If using a VHD, unmount it by ejecting any of the mounted drives and then start the IoT Core VM via HyperV
5. Start an [SSH session](../connect-your-device/ssh.md) and login as administrator 
6. Navigate to c:\test directory in your SSH session
7. Import Fiddler Root Certificate via command:
	* `certmgr -add FiddlerRoot.cer -r localmachine -s root`
8. Close SSH session


## Setup Proxy on VM or IoT Core Device
The steps below will allow your IoT VM or device to route traffic through your PC so that Fiddler can capture network traffic for analysis:

1. Determine the IP of your development machine using a CMD console via _ipconfig_
2. Start a new SSH session and this time, login as defaultUser (Username: _DefaultAccount_  Pwd: _[blank]_ )
3. Set the proxy via the following commands:
	* `reg add "hkcu\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v ProxyEnable /t REG_DWORD /d 1`
	* `reg add "hkcu\Software\Microsoft\Windows\CurrentVersion\Internet Settings" /v ProxyServer /t REG_SZ /d [PC IP address]:8888`

If not already running, start Fiddler on your PC, restart your VM or IoT Core device and traffic should now be routed through Fiddler. 

Note: If you see https CONNECT in Fiddler but no data, the certificate was likely not installed correctly. Make sure you didn't miss the _Transfer and Import Fiddler Root Certificate_ steps above.

Additonally, if you wish to turn the proxy back off note that the above reg keys get cached in a binary blob in another key. so, in addition to removing the keys just added in step 3 above you also need to do:

	reg delete "hkcu\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Connections"
	
	
